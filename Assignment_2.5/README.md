# Звіт про реалізацію проєкту: AI Referee for Rock-Paper-Scissors

## 1. Опис проєкту

Метою роботи була розробка системи комп'ютерного зору для гри "Камінь-Ножиці-Папір" проти штучного інтелекту в реальному часі. Система базується на нейромережі архітектури **YOLOv8** для детекції жестів та машині станів (State Machine) для управління логікою гри.

**Ключові особливості:**

* Робота в реальному часі (Real-time Inference).
* Оптимізація під обмежені ресурси GPU.
* Висока стійкість до хибних спрацювань завдяки використанню Background Images.

---

## 2. Технічний стек та Обладнання

* **Модель:** YOLOv8 Nano (`yolov8n.pt`) — обрана за баланс швидкості та точності.
* **Фреймворк:** PyTorch + Ultralytics.
* **Мова:** Python 3.10.
* **Бібліотеки:** OpenCV (візуалізація), Roboflow (завантаження даних).
* **Апаратне забезпечення:** NVIDIA GeForce RTX 3050 Laptop.

---

## 3. Етапи розробки

### Етап 1: Підготовка даних

Використано датасет з платформи Roboflow Universe.

* **Класи:** `Rock`, `Paper`, `Scissors`.
* **Обсяг:** 6455 зображень у тренувальній вибірці, 576 — у валідаційній.
* **Особливість:** Датасет містить значний відсоток (~39%) "негативних прикладів" (зображення без рук), що дозволило навчити модель ігнорувати фонові об'єкти.

### Етап 2: Навчання моделі (Training)

Навчання проводилось з урахуванням апаратних обмежень (4GB VRAM).
**Гіперпараметри:**

* `imgsz = 416` (зменшено зі стандартних 640 для економії пам'яті та підвищення FPS).
* `batch = 16`.
* `epochs = 30`.
* `amp = True` (Automatic Mixed Precision).

### Етап 3: Розробка ігрового рушія

Реалізовано скрипт на Python (`main.py`), який обробляє відеопотік з веб-камери.
**Логіка:**

1. **Waiting:** Очікування старту гравцем.
2. **Countdown:** Таймер зворотного відліку (3-2-1).
3. **Inference:** Миттєва детекція жесту в момент завершення таймера.
4. **Result:** Порівняння ходу гравця з ходом AI та визначення переможця.

---

## 4. Результати роботи моделі

Навчання зайняло прибл. 24 хвилини на RTX 3050.
Модель продемонструвала виняткову точність та стабільність.

### Підсумкові метрики (Validation Set)

| Метрика | Значення | Опис |
| :--- | :--- | :--- |
| **mAP@50** | **0.953** | Основний показник якості детекції. Результат >95% свідчить про готовність до продакшену. |
| **mAP@50-95** | **0.777** | Показник точності позиціонування рамок (Bounding Box). |
| **Precision** | **0.949** | Висока точність мінімізує хибні спрацювання (False Positives). |
| **Recall** | **0.924** | Модель пропускає менше 8% реальних жестів. |

### Деталізація по класах

* **Paper:** mAP@50 = 0.952
* **Rock:** mAP@50 = 0.951
* **Scissors:** mAP@50 = 0.957
*Висновок:* Модель збалансована, не має "улюблених" класів.

### Швидкодія (Inference Speed)

* **Pre-process:** 0.6ms
* **Inference:** **2.7ms** (~370 FPS теоретично)
* **Post-process:** 0.9ms

Загальна затримка менше 5 мс дозволяє системі працювати значно швидше за частоту оновлення будь-якої стандартної веб-камери (60 FPS).

---

## 5. Демонстрація роботи

[Play demo video](./assets/demo_1.mp4)

---

## 6. Висновок

В ході роботи було створено простенький застосунок комп'ютерного зору. Використання архітектури YOLOv8 Nano у поєднанні зі зменшеним розміром вхідного зображення (416px) дозволило досягти **mAP 95.3%** при надвисокій швидкості роботи на власній відеокарті.
Цікаве спостереження: модель краще і швидше розпізнає жести правою рукою, через те що більшість людей які були в датасеті - правші.
Система успішно розпізнає жести, ігнорує складний фон та забезпечує плавний ігровий процес.
